package pkg

import java.util.Iterator
import kotlin.contracts.InvocationKind

class TestContracts {
   public fun testSimpleContract(x: Int?): Int {
      contract {
         returns() implies (x != null)
      }

      if (x == null) {// 13
         throw new IllegalStateException("x is null".toString());
      } else {
         return x;// 14
      }
   }

   public fun testBooleanContract(a: Boolean, b: Boolean): Boolean? {
      contract {
         returns(true) implies (!a && !b)
         returns(null) implies (a && b)
         returns(false) implies ((a && !b || (!a && b)
      }

      return if (a && b) null else a || b;// 24
   }

   public fun testTypeContract(x: Any?): Int {
      contract {
         returns() implies (x is Int)
      }

      if (x !is Integer) {// 31
         throw new IllegalStateException("x is not Int".toString());
      } else {
         return (x as java.lang.Number).intValue();// 32
      }
   }

   public fun testFunctionalContract(f: () -> Int): Int {
      contract {
         callsInPlace(f, InvocationKind.EXACTLY_ONCE)
      }

      return (f.invoke() as java.lang.Number).intValue();// 39
   }

   public fun testFunctionalContract2(f: () -> Int, b: Boolean): Int {
      contract {
         callsInPlace(f, InvocationKind.AT_MOST_ONCE)
      }

      return if (b) (f.invoke() as java.lang.Number).intValue() else 0;// 46
   }

   public fun testFunctionalContract3(f: () -> Int, i: Int): Int {
      contract {
         callsInPlace(f)
      }

      var var3: java.lang.Iterable = (new IntRange(0, i)) as java.lang.Iterable;
      var var4: Int = 0;

      for (Iterator var5 = var3.iterator(); var5.hasNext(); var4 += ((java.lang.Number)f.invoke()).intValue()) {
         var var6: Int = (var5 as IntIterator).nextInt();
      }

      return var4;// 53
   }
}

class 'pkg/TestContracts' {
   method 'testSimpleContract (Ljava/lang/Integer;)I' {
      1      11
      2      11
      9      12
      a      12
      b      12
      c      12
      d      12
      11      12
      12      14
      13      14
      14      14
      15      14
      16      14
   }

   method 'testBooleanContract (ZZ)Ljava/lang/Boolean;' {
      1      25
      2      25
      5      25
      6      25
      9      25
      d      25
      e      25
      11      25
      12      25
      1a      25
      1d      25
   }

   method 'testTypeContract (Ljava/lang/Object;)I' {
      1      33
      5      33
      c      34
      d      34
      e      34
      f      34
      10      34
      14      34
      15      36
      16      36
      17      36
      18      36
      19      36
      1a      36
      1b      36
      1c      36
   }

   method 'testFunctionalContract (Lkotlin/jvm/functions/Function0;)I' {
      7      45
      8      45
      9      45
      a      45
      b      45
      c      45
      d      45
      e      45
      f      45
      10      45
      11      45
      12      45
      13      45
   }

   method 'testFunctionalContract2 (Lkotlin/jvm/functions/Function0;Z)I' {
      7      53
      8      53
      b      53
      c      53
      d      53
      e      53
      f      53
      10      53
      11      53
      12      53
      13      53
      14      53
      15      53
      16      53
      1a      53
      1b      53
   }

   method 'testFunctionalContract3 (Lkotlin/jvm/functions/Function0;I)I' {
      b      61
      c      61
      10      61
      11      61
      12      61
      13      61
      14      62
      15      62
      16      62
      17      64
      18      64
      19      64
      1a      64
      1b      64
      1c      64
      1d      64
      1e      64
      1f      64
      20      64
      21      64
      22      64
      23      64
      24      64
      25      64
      29      65
      2a      65
      2b      65
      2c      65
      2d      65
      2e      65
      2f      65
      30      65
      31      65
      32      65
      3e      64
      3f      64
      40      64
      41      64
      42      64
      43      64
      44      64
      45      64
      46      64
      47      64
      48      64
      49      64
      4e      64
      4f      64
      51      64
      52      64
      56      68
      57      68
      58      68
   }
}

Lines mapping:
13 <-> 12
14 <-> 15
24 <-> 26
31 <-> 34
32 <-> 37
39 <-> 46
46 <-> 54
53 <-> 69
Not mapped:
10
18
28
36
43
50
57
